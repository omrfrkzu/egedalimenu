# Prevent directory listing
Options -Indexes

# Ensure PHP files are executed
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php
</FilesMatch>

# Security headers
<IfModule mod_headers.c>
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
</IfModule>

# Protect data directory
<FilesMatch "\.json$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Allow access to menu.json via PHP
<Files "menu.json">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</Files>

# Rewrite rule to support /api/menu.php -> api-php/menu.php
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^api/menu\.php$ api-php/menu.php [L]
</IfModule>
